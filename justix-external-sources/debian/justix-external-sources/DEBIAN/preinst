#!/bin/sh
# preinst script for sample-package
#
# see: dh_installdeb(1)

set -e

# summary of how this script can be called:
#        * <new-preinst> `install'
#        * <new-preinst> `install' <old-version>
#        * <new-preinst> `upgrade' <old-version>
#        * <old-preinst> `abort-upgrade' <new-version>
# for details, see https://www.debian.org/doc/debian-policy/ or
# the debian-policy package


case "$1" in
    install|upgrade)

    gpgconf --kill dirmngr

    # Adding keys for sources
   
    echo "\e[1m\e[93m [Justix] \e[95m Downloading mongoDB keys... \e[0m"
    curl "https://www.mongodb.org/static/pgp/server-4.2.asc" | gpg --dearmor > /tmp/mongodb.gpg
    install -o root -g root -m 644 /tmp/mongodb.gpg /etc/apt/trusted.gpg.d/

    echo "\e[1m\e[93m [Justix] \e[95m Downloading VSCode keys... \e[0m"
    curl "https://packages.microsoft.com/keys/microsoft.asc" | gpg --dearmor > /tmp/microsoft.gpg
    install -o root -g root -m 644 /tmp/microsoft.gpg /etc/apt/trusted.gpg.d/

    # Google Chrome Key
    echo "\e[1m\e[93m [Justix] \e[95m Importing Google Chrome keys... \e[0m"
    curl "https://dl-ssl.google.com/linux/linux_signing_key.pub" | gpg --dearmor > /tmp/google.gpg
    install -o root -g root -m 644 /tmp/google.gpg /etc/apt/trusted.gpg.d/

    # Virtualbox Keys
    echo "\e[1m\e[93m [Justix] \e[95m Importing Oracle Virtualbox keys... \e[0m"
    curl "https://www.virtualbox.org/download/oracle_vbox_2016.asc"   | gpg --dearmor > /tmp/oracle.gpg
    install -o root -g root -m 644 /tmp/oracle.gpg /etc/apt/trusted.gpg.d/

    # Docker
    echo "\e[1m\e[93m [Justix] \e[95m Importing Docker keys... \e[0m"
    curl -fsSL "https://download.docker.com/linux/ubuntu/gpg" |  gpg --dearmor > /tmp/docker.gpg
    install -o root -g root -m 644 /tmp/docker.gpg /etc/apt/trusted.gpg.d/

    # Xenlism icon theme
    apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 2B80AC38
    echo "\e[1m\e[93m [Justix] \e[95m Importing Xenlism keys... \e[0m"
    curl "https://keyserver.ubuntu.com/pks/lookup?op=get&search=0x067FB4A0B6D9380A" |  gpg --dearmor > /tmp/xenlism.gpg
    install -o root -g root -m 644 /tmp/xenlism.gpg /etc/apt/trusted.gpg.d/
    
    # Gimp
    echo "\e[1m\e[93m [Justix] \e[95m Importing Gimp Stable keys... \e[0m"
    curl "https://keyserver.ubuntu.com/pks/lookup?op=get&search=0xFB97E9C3A97F85C095AEA7903BDAAC08614C4B38" |  gpg --dearmor > /tmp/gimp.gpg
    install -o root -g root -m 644 /tmp/gimp.gpg /etc/apt/trusted.gpg.d/

    # Gradle
    echo "\e[1m\e[93m [Justix] \e[95m Importing Gradle keys... \e[0m"
    curl "https://keyserver.ubuntu.com/pks/lookup?op=get&search=0x3D16156328D0E3056D885D0BD7CC6F019D06AF36" |  gpg --dearmor > /tmp/gradle.gpg
    install -o root -g root -m 644 /tmp/gradle.gpg /etc/apt/trusted.gpg.d/

    # Ubuntu make
    echo "\e[1m\e[93m [Justix] \e[95m Importing Ubuntu make keys... \e[0m"
    curl "https://keyserver.ubuntu.com/pks/lookup?op=get&search=0x2A8F89B722D1D6630348601343FDBC385ADA701F" |  gpg --dearmor > /tmp/umake.gpg
    install -o root -g root -m 644 /tmp/umake.gpg /etc/apt/trusted.gpg.d/



    [ -d ~/.gnupg ] && chown -R $USER:$USER ~/.gnupg
    ;;


    abort-upgrade)
    ;;

    *)
        echo "preinst called with unknown argument \`$1'" >&2
        exit 1
    ;;
esac

# dh_installdeb will replace this with shell code automatically
# generated by other debhelper scripts.



exit 0
